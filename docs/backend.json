
{
  "entities": {
    "Coach": {
      "title": "Coach",
      "type": "object",
      "description": "Represents a coach, who acts as a tenant in the system.",
      "properties": {
        "displayName": { "type": "string" },
        "email": { "type": "string", "format": "email" },
        "phone": { "type": "string" },
        "brand": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "logoUrl": { "type": "string", "format": "uri" },
            "color": { "type": "string" }
          }
        },
        "plan": {
          "type": "object",
          "properties": {
            "tier": { "type": "string", "enum": ["free", "pro", "enterprise"] },
            "seats": { "type": "number" },
            "expiresAt": { "type": "string", "format": "date-time" }
          }
        },
        "settings": {
          "type": "object",
          "properties": {
            "locale": { "type": "string", "enum": ["en", "ur"] },
            "lowBandwidthDefault": { "type": "boolean" }
          }
        },
        "createdAt": { "type": "string", "format": "date-time" },
        "updatedAt": { "type": "string", "format": "date-time" }
      },
      "required": ["displayName", "email", "plan", "settings"]
    },
    "User": {
      "title": "User",
      "type": "object",
      "description": "Represents any signed-in user of the platform.",
      "properties": {
        "coachId": { "type": "string" },
        "role": { "type": "string", "enum": ["admin", "teacher", "student"] },
        "profile": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "email": { "type": "string", "format": "email" },
            "photoUrl": { "type": "string", "format": "uri" }
          }
        },
        "status": { "type": "string", "enum": ["active", "invited", "disabled"] },
        "createdAt": { "type": "string", "format": "date-time" },
        "updatedAt": { "type": "string", "format": "date-time" }
      },
      "required": ["coachId", "role", "profile", "status"]
    },
    "Plan": {
        "title": "Plan",
        "type": "object",
        "description": "Subscription plan details",
        "properties": {
            "title": { "type": "string" },
            "tier": { "type": "string", "enum": ["free", "pro", "enterprise"] },
            "pricePKR": { "type": "number" },
            "priceUSD": { "type": "number" },
            "seatLimit": { "type": "number" },
            "features": { "type": "string" },
            "isActive": { "type": "boolean" },
            "sort": { "type": "number" },
            "createdAt": { "type": "string", "format": "date-time" },
            "updatedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["title", "tier", "pricePKR", "seatLimit", "isActive", "sort"]
    },
    "Subscription": {
        "title": "Subscription",
        "type": "object",
        "description": "A coach's subscription.",
        "properties": {
            "coachId": { "type": "string" },
            "planId": { "type": "string" },
            "tier": { "type": "string", "enum": ["free", "pro", "enterprise"] },
            "seatLimit": { "type": "number" },
            "status": { "type": "string", "enum": ["active", "past_due", "canceled", "awaiting_payment"] },
            "currentPeriodEnd": { "type": "string", "format": "date-time" },
            "createdAt": { "type": "string", "format": "date-time" },
            "updatedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["coachId", "planId", "tier", "seatLimit", "status"]
    },
    "Payment": {
        "title": "Payment",
        "type": "object",
        "description": "A payment record.",
        "properties": {
            "coachId": { "type": "string" },
            "amount": { "type": "number" },
            "currency": { "type": "string", "enum": ["PKR", "USD"] },
            "method": { "type": "string", "enum": ["manual_bank", "card", "waiver"] },
            "status": { "type": "string", "enum": ["pending", "approved", "rejected"] },
            "reference": { "type": "string" },
            "bankSlipUrl": { "type": "string", "format": "uri" },
            "notes": { "type": "string" },
            "reviewedBy": { "type": "string" },
            "reviewedAt": { "type": "string", "format": "date-time" },
            "createdAt": { "type": "string", "format": "date-time" },
            "updatedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["coachId", "amount", "currency", "method", "status"]
    },
    "Invoice": {
        "title": "Invoice",
        "type": "object",
        "description": "An invoice for a coach.",
        "properties": {
            "coachId": { "type": "string" },
            "items": { 
                "type": "array", 
                "items": { 
                    "type": "object",
                    "properties": {
                        "label": { "type": "string" },
                        "amount": { "type": "number" }
                    }
                } 
            },
            "total": { "type": "number" },
            "currency": { "type": "string", "enum": ["PKR", "USD"] },
            "status": { "type": "string", "enum": ["draft", "sent", "paid", "void"] },
            "dueAt": { "type": "string", "format": "date-time" },
            "createdAt": { "type": "string", "format": "date-time" }
        },
        "required": ["coachId", "items", "total", "currency", "status"]
    },
    "Audit": {
        "title": "Audit",
        "type": "object",
        "description": "An audit log entry.",
        "properties": {
            "coachId": { "type": "string" },
            "actorId": { "type": "string" },
            "action": { "type": "string" },
            "target": {
                "type": "object",
                "properties": {
                    "collection": { "type": "string" },
                    "id": { "type": "string" }
                }
            },
            "meta": { "type": "object" },
            "ts": { "type": "string", "format": "date-time" }
        },
        "required": ["actorId", "action", "target", "ts"]
    },
    "TeacherSubscription": {
        "title": "TeacherSubscription",
        "type": "object",
        "description": "Legacy subscription model.",
        "properties": {
            "userId": { "type": "string" },
            "subscriptionPlanId": { "type": "string" },
            "paymentMethod": { "type": "string" },
            "transactionId": { "type": "string" },
            "paymentStatus": { "type": "string" },
            "createdAt": { "type": "string", "format": "date-time" },
            "updatedAt": { "type": "string", "format": "date-time" }
        }
    }
  },
  "auth": {
    "providers": [
      "password",
      "google.com"
    ],
    "customClaims": ["role", "coachId"]
  },
  "firestore": {
    "/coaches/{coachId}": { "schema": { "$ref": "#/entities/Coach" }, "description": "Stores details for each coach (tenant)." },
    "/users/{userId}": { "schema": { "$ref": "#/entities/User" }, "description": "Stores all users across all coaches." },
    "/subscription_plans/{planId}": { "schema": { "$ref": "#/entities/Plan" }, "description": "Stores subscription plan details." },
    "/subscriptions/{subId}": { "schema": { "$ref": "#/entities/Subscription" }, "description": "Stores coach subscription details." },
    "/payments/{paymentId}": { "schema": { "$ref": "#/entities/Payment" }, "description": "Payment transaction records." },
    "/invoices/{invoiceId}": { "schema": { "$ref": "#/entities/Invoice" }, "description": "Stores invoice details." },
    "/audit/{auditId}": { "schema": { "$ref": "#/entities/Audit" }, "description": "Audit trail for important actions." },
    "/settings/theme": { "schema": {}, "description": "Global theme settings." },
    "/teacher_subscriptions/{id}": { "schema": { "$ref": "#/entities/TeacherSubscription" }, "description": "Legacy subscriptions." }
  }
}
